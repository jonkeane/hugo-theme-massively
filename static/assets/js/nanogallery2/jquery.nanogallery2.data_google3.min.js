/* nanogallery2 - v3.0.5 - 2024-03-14 */
/**!
 * @preserve nanogallery2 - GOOGLE PHOTOS data provider
 * Homepage: http://nanogallery2.nanostudio.org
 * Sources:  https://github.com/nanostudio-org/nanogallery2
 *
 * License:  GPLv3 and commercial licence
 * 
*/
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","nanogallery2"],e):"object"==typeof exports&&"function"==typeof require?e(require(["jquery","nanogallery2"])):e(jQuery)}((function(e){jQuery.nanogallery2.data_google2=function(e,t){var a=e;function o(e,t,o,i,n,r){for(var l=["xs","sm","me","la","xl"],d=0;d<l.length;d++){if("image"==i){if("auto"==a.tn.settings.width[e][l[d]]){let i=r/n;t.height[e][l[d]]=a.tn.settings.getH(e,l[d]),t.width[e][l[d]]=a.tn.settings.getH(e,l[d])*i,t.url[e][l[d]]=o.baseUrl+"=h"+a.tn.settings.getH(e,l[d]);continue}if("auto"==a.tn.settings.height[e][l[d]]){let i=n/r;t.width[e][l[d]]=a.tn.settings.getW(e,l[d]),t.height[e][l[d]]=a.tn.settings.getW(e,l[d])*i,t.url[e][l[d]]=o.baseUrl+"=w"+a.tn.settings.getW(e,l[d]);continue}t.height[e][l[d]]=a.tn.settings.getH(e,l[d]),t.width[e][l[d]]=a.tn.settings.getW(e,l[d]),t.url[e][l[d]]=o.baseUrl+"=w"+a.tn.settings.getW(e,l[d])}if("album"==i){if("auto"==a.tn.settings.width[e][l[d]]){t.url[e][l[d]]=o.coverPhotoBaseUrl+"=h"+a.tn.settings.getH(e,l[d]);continue}if("auto"==a.tn.settings.height[e][l[d]]){t.url[e][l[d]]=o.coverPhotoBaseUrl+"=w"+a.tn.settings.getW(e,l[d]);continue}t.url[e][l[d]]=o.coverPhotoBaseUrl+"=h"+a.tn.settings.getH(e,l[d])+"-w"+a.tn.settings.getW(e,l[d])}}return t}var i=NGY2Tools.PreloaderDisplay.bind(a),n=NGY2Tools.NanoAlert,r=NGY2Tools.GetImageTitleFromURL.bind(a),l=NGY2Tools.FilterAlbumName.bind(a),d=NGY2Tools.AlbumPostProcess.bind(a);"AlbumGetContent"===t&&function(e,t,u,g){var m="",h="image",c=NGY2Item.GetIdx(a,e),f="";a.galleryMaxItems.Get()>0&&(f="&max-results="+a.galleryMaxItems.Get());var p="";"undefined"!=typeof ngy2_pwa_at&&(p=ngy2_pwa_at),0==e?(m=""!=p?"https://photoslibrary.googleapis.com/v1/albums":a.O.google2URL+"?nguserid="+a.O.userID+"&alt=json&v=3&kind=album"+f+"&rnd="+(new Date).getTime(),h="album"):m=""!=p?"https://photoslibrary.googleapis.com/v1/mediaItems:search":a.O.google2URL+"?nguserid="+a.O.userID+"&ngalbumid="+e+"&alt=json&v=3&kind=photo&"+f,a.O.debugMode&&console.log("Google Photos URL: "+m),i(!0),jQuery.ajaxSetup({cache:!1}),jQuery.support.cors=!0;try{var v=setTimeout((function(){i(!1),n("Could not retrieve AJAX data...")}),6e4);jQuery.getJSON(m+"&callback=?",(function(m){if("error"==m.nano_status)return clearTimeout(v),i(!1),void n(a,"Could not retrieve Google data. Error: "+m.nano_message);clearTimeout(v),i(!1),function(e,t,i){a.O.debugMode&&(console.log("Google Photos data:"),console.dir(i));var n=a.I[e].GetID();jQuery.each(i,(function(e,i){if("object"==typeof i&&null!==i){var d="",u="";"image"==t?(void 0!==i.description&&(d=i.description),""!=a.O.thumbnailLabel.get("title")&&(u=r(i.filename))):u=i.title,null==u&&(u="");var g=i.id;if("album"==t&&(!l(u,g)||null==i.coverPhotoBaseUrl))return!0;var m=NGY2Item.New(a,u,d,g,n,t,""),h=0,c=0,f="";"image"==t?(f=i.baseUrl,a.O.viewerZoom||null==a.O.viewerZoom?f+="=h"+i.mediaMetadata.height+"-w"+i.mediaMetadata.width:window.screen.width>window.screen.height?f+="=w"+window.screen.width:f=s+"=h"+window.screen.height,m.setMediaURL(f,"img"),void 0!==i.mediaMetadata.width&&(m.imageWidth=parseInt(i.mediaMetadata.width),h=m.imageWidth),void 0!==i.mediaMetadata.height&&(m.imageHeight=parseInt(i.mediaMetadata.height),c=m.imageHeight),void 0!==i.mediaMetadata.photo&&(null!=i.mediaMetadata.photo.exposureTime&&(m.exif.exposure=i.mediaMetadata.photo.exposureTime),null!=i.mediaMetadata.photo.focalLength&&(m.exif.focallength=i.mediaMetadata.photo.focalLength),null!=i.mediaMetadata.photo.apertureFNumber&&(m.exif.fstop=i.mediaMetadata.photo.apertureFNumber),null!=i.mediaMetadata.photo.isoEquivalent&&(m.exif.iso=i.mediaMetadata.photo.isoEquivalent),null!=i.mediaMetadata.photo.cameraModel&&(m.exif.model=i.mediaMetadata.photo.cameraModel)),void 0!==i.mediaMetadata.video&&(null!=i.mediaMetadata.video.cameraModel&&(m.exif.model=i.mediaMetadata.video.cameraModel),m.downloadURL=i.baseUrl+"=dv")):m.numberItems=i.mediaItemsCount,m.thumbs=o("l1",m.thumbs,i,t,c,h),m.thumbs=o("lN",m.thumbs,i,t,c,h);var p=a.O.fnProcessData;null!==p&&("function"==typeof p?p(m,"google2",i):window[p](m,"google2",i))}})),a.I[e].contentIsLoaded=!0}(c,h,m),d(e),null!=t&&t(u,g,null)})).fail((function(e,t,o){clearTimeout(v),i(!1);var r="";for(var l in e)r+=l+"="+e[l]+"<br>";n(a,"Could not retrieve Google data. Error: "+t+", "+o+" "+r+"<br><br>URL:"+m)}))}catch(e){n(a,"Could not retrieve Google data. Error: "+e)}}(arguments[2],arguments[3],arguments[4],arguments[5])}}));